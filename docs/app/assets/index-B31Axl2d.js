(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var V,y,Se,$,le,Te,je,Ee,ne,K,X,M={},De=[],Re=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,q=Array.isArray;function I(e,t){for(var n in t)e[n]=t[n];return e}function re(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Je(e,t,n){var s,r,o,a={};for(o in t)o=="key"?s=t[o]:o=="ref"?r=t[o]:a[o]=t[o];if(arguments.length>2&&(a.children=arguments.length>3?V.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)a[o]===void 0&&(a[o]=e.defaultProps[o]);return H(e,a,s,r,null)}function H(e,t,n,s,r){var o={type:e,props:t,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Se,__i:-1,__u:0};return r==null&&y.vnode!=null&&y.vnode(o),o}function z(e){return e.children}function R(e,t){this.props=e,this.context=t}function F(e,t){if(t==null)return e.__?F(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?F(e):null}function Ce(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Ce(e)}}function ae(e){(!e.__d&&(e.__d=!0)&&$.push(e)&&!W.__r++||le!=y.debounceRendering)&&((le=y.debounceRendering)||Te)(W)}function W(){for(var e,t,n,s,r,o,a,c=1;$.length;)$.length>c&&$.sort(je),e=$.shift(),c=$.length,e.__d&&(n=void 0,s=void 0,r=(s=(t=e).__v).__e,o=[],a=[],t.__P&&((n=I({},s)).__v=s.__v+1,y.vnode&&y.vnode(n),se(t.__P,n,s,t.__n,t.__P.namespaceURI,32&s.__u?[r]:null,o,r??F(s),!!(32&s.__u),a),n.__v=s.__v,n.__.__k[n.__i]=n,Ne(o,n,a),s.__e=s.__=null,n.__e!=r&&Ce(n)));W.__r=0}function Ie(e,t,n,s,r,o,a,c,p,_,d){var l,f,u,g,b,w,v,h=s&&s.__k||De,E=t.length;for(p=We(n,t,h,p,E),l=0;l<E;l++)(u=n.__k[l])!=null&&(f=u.__i==-1?M:h[u.__i]||M,u.__i=l,w=se(e,u,f,r,o,a,c,p,_,d),g=u.__e,u.ref&&f.ref!=u.ref&&(f.ref&&oe(f.ref,null,u),d.push(u.ref,u.__c||g,u)),b==null&&g!=null&&(b=g),(v=!!(4&u.__u))||f.__k===u.__k?p=Le(u,p,e,v):typeof u.type=="function"&&w!==void 0?p=w:g&&(p=g.nextSibling),u.__u&=-7);return n.__e=b,p}function We(e,t,n,s,r){var o,a,c,p,_,d=n.length,l=d,f=0;for(e.__k=new Array(r),o=0;o<r;o++)(a=t[o])!=null&&typeof a!="boolean"&&typeof a!="function"?(p=o+f,(a=e.__k[o]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?H(null,a,null,null,null):q(a)?H(z,{children:a},null,null,null):a.constructor==null&&a.__b>0?H(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=e,a.__b=e.__b+1,c=null,(_=a.__i=Be(a,n,p,l))!=-1&&(l--,(c=n[_])&&(c.__u|=2)),c==null||c.__v==null?(_==-1&&(r>d?f--:r<d&&f++),typeof a.type!="function"&&(a.__u|=4)):_!=p&&(_==p-1?f--:_==p+1?f++:(_>p?f--:f++,a.__u|=4))):e.__k[o]=null;if(l)for(o=0;o<d;o++)(c=n[o])!=null&&!(2&c.__u)&&(c.__e==s&&(s=F(c)),Pe(c,c));return s}function Le(e,t,n,s){var r,o;if(typeof e.type=="function"){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=Le(r[o],t,n,s));return t}e.__e!=t&&(s&&(t&&e.type&&!t.parentNode&&(t=F(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Be(e,t,n,s){var r,o,a,c=e.key,p=e.type,_=t[n],d=_!=null&&(2&_.__u)==0;if(_===null&&e.key==null||d&&c==_.key&&p==_.type)return n;if(s>(d?1:0)){for(r=n-1,o=n+1;r>=0||o<t.length;)if((_=t[a=r>=0?r--:o++])!=null&&!(2&_.__u)&&c==_.key&&p==_.type)return a}return-1}function ce(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Re.test(t)?n:n+"px"}function O(e,t,n,s,r){var o,a;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(t in s)n&&t in n||ce(e.style,t,"");if(n)for(t in n)s&&n[t]==s[t]||ce(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(Ee,"$1")),a=t.toLowerCase(),t=a in e||t=="onFocusOut"||t=="onFocusIn"?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?s?n.u=s.u:(n.u=ne,e.addEventListener(t,o?X:K,o)):e.removeEventListener(t,o?X:K,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function _e(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ne++;else if(t.t<n.u)return;return n(y.event?y.event(t):t)}}}function se(e,t,n,s,r,o,a,c,p,_){var d,l,f,u,g,b,w,v,h,E,m,T,x,N,L,D,U,C=t.type;if(t.constructor!=null)return null;128&n.__u&&(p=!!(32&n.__u),o=[c=t.__e=n.__e]),(d=y.__b)&&d(t);e:if(typeof C=="function")try{if(v=t.props,h="prototype"in C&&C.prototype.render,E=(d=C.contextType)&&s[d.__c],m=d?E?E.props.value:d.__:s,n.__c?w=(l=t.__c=n.__c).__=l.__E:(h?t.__c=l=new C(v,m):(t.__c=l=new R(v,m),l.constructor=C,l.render=qe),E&&E.sub(l),l.props=v,l.state||(l.state={}),l.context=m,l.__n=s,f=l.__d=!0,l.__h=[],l._sb=[]),h&&l.__s==null&&(l.__s=l.state),h&&C.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=I({},l.__s)),I(l.__s,C.getDerivedStateFromProps(v,l.__s))),u=l.props,g=l.state,l.__v=t,f)h&&C.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),h&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(h&&C.getDerivedStateFromProps==null&&v!==u&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(v,m),!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(v,l.__s,m)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(l.props=v,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(P){P&&(P.__=t)}),T=0;T<l._sb.length;T++)l.__h.push(l._sb[T]);l._sb=[],l.__h.length&&a.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(v,l.__s,m),h&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(u,g,b)})}if(l.context=m,l.props=v,l.__P=e,l.__e=!1,x=y.__r,N=0,h){for(l.state=l.__s,l.__d=!1,x&&x(t),d=l.render(l.props,l.state,l.context),L=0;L<l._sb.length;L++)l.__h.push(l._sb[L]);l._sb=[]}else do l.__d=!1,x&&x(t),d=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++N<25);l.state=l.__s,l.getChildContext!=null&&(s=I(I({},s),l.getChildContext())),h&&!f&&l.getSnapshotBeforeUpdate!=null&&(b=l.getSnapshotBeforeUpdate(u,g)),D=d,d!=null&&d.type===z&&d.key==null&&(D=$e(d.props.children)),c=Ie(e,q(D)?D:[D],t,n,s,r,o,a,c,p,_),l.base=t.__e,t.__u&=-161,l.__h.length&&a.push(l),w&&(l.__E=l.__=null)}catch(P){if(t.__v=null,p||o!=null)if(P.then){for(t.__u|=p?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,t.__e=c}else{for(U=o.length;U--;)re(o[U]);Q(t)}else t.__e=n.__e,t.__k=n.__k,P.then||Q(t);y.__e(P,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):c=t.__e=Ve(n.__e,t,n,s,r,o,a,p,_);return(d=y.diffed)&&d(t),128&t.__u?void 0:c}function Q(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Q)}function Ne(e,t,n){for(var s=0;s<n.length;s++)oe(n[s],n[++s],n[++s]);y.__c&&y.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){y.__e(o,r.__v)}})}function $e(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:q(e)?e.map($e):I({},e)}function Ve(e,t,n,s,r,o,a,c,p){var _,d,l,f,u,g,b,w=n.props,v=t.props,h=t.type;if(h=="svg"?r="http://www.w3.org/2000/svg":h=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(_=0;_<o.length;_++)if((u=o[_])&&"setAttribute"in u==!!h&&(h?u.localName==h:u.nodeType==3)){e=u,o[_]=null;break}}if(e==null){if(h==null)return document.createTextNode(v);e=document.createElementNS(r,h,v.is&&v),c&&(y.__m&&y.__m(t,o),c=!1),o=null}if(h==null)w===v||c&&e.data==v||(e.data=v);else{if(o=o&&V.call(e.childNodes),w=n.props||M,!c&&o!=null)for(w={},_=0;_<e.attributes.length;_++)w[(u=e.attributes[_]).name]=u.value;for(_ in w)if(u=w[_],_!="children"){if(_=="dangerouslySetInnerHTML")l=u;else if(!(_ in v)){if(_=="value"&&"defaultValue"in v||_=="checked"&&"defaultChecked"in v)continue;O(e,_,null,u,r)}}for(_ in v)u=v[_],_=="children"?f=u:_=="dangerouslySetInnerHTML"?d=u:_=="value"?g=u:_=="checked"?b=u:c&&typeof u!="function"||w[_]===u||O(e,_,u,w[_],r);if(d)c||l&&(d.__html==l.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(l&&(e.innerHTML=""),Ie(t.type=="template"?e.content:e,q(f)?f:[f],t,n,s,h=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,a,o?o[0]:n.__k&&F(n,0),c,p),o!=null)for(_=o.length;_--;)re(o[_]);c||(_="value",h=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[_]||h=="progress"&&!g||h=="option"&&g!=w[_])&&O(e,_,g,w[_],r),_="checked",b!=null&&b!=e[_]&&O(e,_,b,w[_],r))}return e}function oe(e,t,n){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&t==null||(e.__u=e(t))}else e.current=t}catch(r){y.__e(r,n)}}function Pe(e,t,n){var s,r;if(y.unmount&&y.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||oe(s,null,t)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){y.__e(o,t)}s.base=s.__P=null}if(s=e.__k)for(r=0;r<s.length;r++)s[r]&&Pe(s[r],t,n||typeof e.type!="function");n||re(e.__e),e.__c=e.__=e.__e=void 0}function qe(e,t,n){return this.constructor(e,n)}function ze(e,t,n){var s,r,o,a;t==document&&(t=document.documentElement),y.__&&y.__(e,t),r=(s=!1)?null:t.__k,o=[],a=[],se(t,e=t.__k=Je(z,null,[e]),r||M,M,t.namespaceURI,r?null:t.firstChild?V.call(t.childNodes):null,o,r?r.__e:t.firstChild,s,a),Ne(o,e,a)}V=De.slice,y={__e:function(e,t,n,s){for(var r,o,a;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,s||{}),a=r.__d),a)return r.__E=r}catch(c){e=c}throw e}},Se=0,R.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=I({},this.state),typeof e=="function"&&(e=e(I({},n),this.props)),e&&I(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ae(this))},R.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ae(this))},R.prototype.render=z,$=[],Te=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,je=function(e,t){return e.__v.__b-t.__v.__b},W.__r=0,Ee=/(PointerCapture)$|Capture$/i,ne=0,K=_e(!1),X=_e(!0);var Ge=0;function i(e,t,n,s,r,o){t||(t={});var a,c,p=t;if("ref"in p)for(c in p={},t)c=="ref"?a=t[c]:p[c]=t[c];var _={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ge,__i:-1,__u:0,__source:r,__self:o};if(typeof e=="function"&&(a=e.defaultProps))for(c in a)p[c]===void 0&&(p[c]=a[c]);return y.vnode&&y.vnode(_),_}var A,k,G,de,B=0,Fe=[],S=y,pe=S.__b,ue=S.__r,fe=S.diffed,he=S.__c,me=S.unmount,ve=S.__;function ie(e,t){S.__h&&S.__h(k,e,B||t),B=0;var n=k.__H||(k.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function j(e){return B=1,Ye(Ae,e)}function Ye(e,t,n){var s=ie(A++,2);if(s.t=e,!s.__c&&(s.__=[Ae(void 0,t),function(c){var p=s.__N?s.__N[0]:s.__[0],_=s.t(p,c);p!==_&&(s.__N=[_,s.__[1]],s.__c.setState({}))}],s.__c=k,!k.__f)){var r=function(c,p,_){if(!s.__c.__H)return!0;var d=s.__c.__H.__.filter(function(f){return!!f.__c});if(d.every(function(f){return!f.__N}))return!o||o.call(this,c,p,_);var l=s.__c.props!==c;return d.forEach(function(f){if(f.__N){var u=f.__[0];f.__=f.__N,f.__N=void 0,u!==f.__[0]&&(l=!0)}}),o&&o.call(this,c,p,_)||l};k.__f=!0;var o=k.shouldComponentUpdate,a=k.componentWillUpdate;k.componentWillUpdate=function(c,p,_){if(this.__e){var d=o;o=void 0,r(c,p,_),o=d}a&&a.call(this,c,p,_)},k.shouldComponentUpdate=r}return s.__N||s.__}function Ue(e,t){var n=ie(A++,3);!S.__s&&Me(n.__H,t)&&(n.__=e,n.u=t,k.__H.__h.push(n))}function Ke(e){return B=5,Xe(function(){return{current:e}},[])}function Xe(e,t){var n=ie(A++,7);return Me(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Qe(){for(var e;e=Fe.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(J),e.__H.__h.forEach(Z),e.__H.__h=[]}catch(t){e.__H.__h=[],S.__e(t,e.__v)}}S.__b=function(e){k=null,pe&&pe(e)},S.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ve&&ve(e,t)},S.__r=function(e){ue&&ue(e),A=0;var t=(k=e.__c).__H;t&&(G===k?(t.__h=[],k.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(J),t.__h.forEach(Z),t.__h=[],A=0)),G=k},S.diffed=function(e){fe&&fe(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Fe.push(t)!==1&&de===S.requestAnimationFrame||((de=S.requestAnimationFrame)||Ze)(Qe)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),G=k=null},S.__c=function(e,t){t.some(function(n){try{n.__h.forEach(J),n.__h=n.__h.filter(function(s){return!s.__||Z(s)})}catch(s){t.some(function(r){r.__h&&(r.__h=[])}),t=[],S.__e(s,n.__v)}}),he&&he(e,t)},S.unmount=function(e){me&&me(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{J(s)}catch(r){t=r}}),n.__H=void 0,t&&S.__e(t,n.__v))};var ge=typeof requestAnimationFrame=="function";function Ze(e){var t,n=function(){clearTimeout(s),ge&&cancelAnimationFrame(t),setTimeout(e)},s=setTimeout(n,35);ge&&(t=requestAnimationFrame(n))}function J(e){var t=k,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),k=t}function Z(e){var t=k;e.__c=e.__(),k=t}function Me(e,t){return!e||e.length!==t.length||t.some(function(n,s){return n!==e[s]})}function Ae(e,t){return typeof t=="function"?t(e):t}function ye(e){const t=new Map;for(const n of e){const s=n.trace_id??"no-trace",r=n.span_id??crypto.randomUUID(),o=n.parent_span_id??null,a=n.timestamp,c=n.event,p=n.level??"info";t.has(s)||t.set(s,{roots:[],nodes:new Map});const _=t.get(s),d=_.nodes.get(r)||{id:r,traceId:s,parentId:o,children:[],depth:0,level:p,msg:c,timestamp:a,raw:[]};!d.msg&&c&&(d.msg=c),!d.timestamp&&a&&(d.timestamp=a),(!d.level||d.level==="info")&&(d.level=p),o&&!d.parentId&&(d.parentId=o),d.raw.push(n),_.nodes.set(r,d)}for(const n of t.values()){const s=new Set;for(const r of n.nodes.values())if(r.parentId){n.nodes.has(r.parentId)||n.nodes.set(r.parentId,{id:r.parentId,traceId:r.traceId,parentId:null,children:[],depth:0,level:"info",msg:`[span ${r.parentId}]`,timestamp:r.timestamp,raw:[]});const o=n.nodes.get(r.parentId);o.children.includes(r.id)||o.children.push(r.id),s.add(r.id)}n.roots=Array.from(n.nodes.keys()).filter(r=>!s.has(r));for(const r of n.nodes.values())r.children.length>1&&r.children.sort((o,a)=>{const c=n.nodes.get(o),p=n.nodes.get(a),_=(c==null?void 0:c.timestamp)||"",d=(p==null?void 0:p.timestamp)||"";return _<d?-1:_>d?1:0})}for(const n of t.values()){const s=new Set,r=(o,a)=>{const c=n.nodes.get(o);!c||s.has(o)||(c.depth=a,s.add(o),c.children.forEach(p=>r(p,a+1)))};n.roots.forEach(o=>r(o,0))}for(const[n,s]of t.entries()){const r=s.roots.length>0?s.nodes.get(s.roots[0]):null;s.name=(r==null?void 0:r.msg)||`Trace ${n}`;let o=null,a=null;for(const c of s.nodes.values())c.timestamp&&((!o||c.timestamp<o)&&(o=c.timestamp),(!a||c.timestamp>a)&&(a=c.timestamp));if(s.startTime=o,s.endTime=a,o&&a){const c=new Date(o).getTime(),p=new Date(a).getTime();s.durationMs=p-c}}return t}const be={mode:"full",decimalPlaces:3,forceEnUS:!1,showInNodes:!0};function ee(e,t,n){if(!e||t.mode==="hidden")return"";try{const s=new Date(e);switch(t.mode){case"relative":{if(!n)return e;const r=new Date(n).getTime(),a=(s.getTime()-r)/1e3;return`${a>=0?"+":""}${a.toFixed(t.decimalPlaces)}s`}case"time":{const r=t.forceEnUS?"en-US":void 0;return s.toLocaleString(r,{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3})}case"full":{const r=t.forceEnUS?"en-US":void 0;return s.toLocaleString(r,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3})}default:return e}}catch{return e}}function et(){try{const e=localStorage.getItem("aitrace_timestamp_settings");if(e)return{...be,...JSON.parse(e)}}catch(e){console.error("Failed to load timestamp settings:",e)}return be}function tt(e){try{localStorage.setItem("aitrace_timestamp_settings",JSON.stringify(e))}catch(t){console.error("Failed to save timestamp settings:",t)}}function we(e){if(typeof e!="string")return e;const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]"))try{return JSON.parse(e)}catch{return e}return e}function xe(e){try{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e)}catch{}const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-10000px",t.style.top="-10000px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch{}return document.body.removeChild(t),Promise.resolve()}function te({value:e,name:t,depth:n=0,maxInitialDepth:s=2}){const[r,o]=j(n<s),[a,c]=j({open:!1,x:0,y:0,jsonText:""}),p=Ke(null);Ue(()=>{const l=f=>{p.current&&!p.current.contains(f.target)&&c(u=>({...u,open:!1}))};return window.addEventListener("click",l),window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("click",l),window.removeEventListener("scroll",l,!0)}},[]);const _=l=>{l.preventDefault();const f=(()=>{try{return JSON.stringify(we(e),null,2)}catch{return String(e)}})(),u=l;c({open:!0,x:u.clientX||0,y:u.clientY||0,jsonText:f})},d=we(e);if(d===null)return i("span",{class:"json-null",children:"null"});if(d===void 0)return i("span",{class:"json-undefined",children:"undefined"});if(typeof d=="boolean")return i("span",{class:"json-boolean",children:d?"true":"false"});if(typeof d=="number")return i("span",{class:"json-number",children:d});if(typeof d=="string"){if(d.length>100){const[l,f]=j(!1);return i("span",{class:"json-string",children:['"',l?d:d.substring(0,100),!l&&"...",'"',i("button",{class:"json-expand-text",onClick:()=>f(!l),children:l?"less":"more"})]})}return i("span",{class:"json-string",children:['"',d,'"']})}if(Array.isArray(d))return d.length===0?i("span",{class:"json-array",children:"[]"}):i("div",{class:"json-array-container",onContextMenu:_,children:[i("span",{class:"json-toggle compact",onClick:()=>o(!r),children:[i("i",{class:`bi bi-chevron-${r?"down":"right"}`}),t&&i("span",{class:"json-key",children:[t,": "]}),i("span",{class:"json-bracket",children:"["}),!r&&i("span",{class:"json-preview",children:[d.length," items"]}),!r&&i("span",{class:"json-bracket",children:"]"})]}),r&&i("div",{class:"json-array-items compact",children:[d.map((l,f)=>i("div",{class:"json-item",children:i(te,{value:l,depth:n+1,maxInitialDepth:s})},f)),i("span",{class:"json-bracket",children:"]"})]}),a.open&&i("div",{ref:p,class:"json-context-menu",style:{top:a.y+"px",left:a.x+"px"},children:[i("button",{class:"menu-item",onClick:()=>{xe(a.jsonText),c(l=>({...l,open:!1}))},children:"Copy JSON"}),i("button",{class:"menu-item",onClick:()=>{const l=new Blob([a.jsonText],{type:"application/json"}),f=document.createElement("a");f.href=URL.createObjectURL(l),f.download="data.json",f.click(),c(u=>({...u,open:!1}))},children:"Download JSON"})]})]});if(typeof d=="object"){const l=Object.entries(d);return l.length===0?i("span",{class:"json-object",children:"{}"}):i("div",{class:"json-object-container",onContextMenu:_,children:[i("span",{class:"json-toggle compact",onClick:()=>o(!r),children:[i("i",{class:`bi bi-chevron-${r?"down":"right"}`}),t&&i("span",{class:"json-key",children:[t,": "]}),i("span",{class:"json-bracket",children:"{"}),!r&&i("span",{class:"json-preview",children:[l.length," props"]}),!r&&i("span",{class:"json-bracket",children:"}"})]}),r&&i("div",{class:"json-object-items compact",children:[l.map(([f,u])=>i("div",{class:"json-property",children:[i("span",{class:"json-key",children:[f,":"]}),i(te,{value:u,depth:n+1,maxInitialDepth:s})]},f)),i("span",{class:"json-bracket",children:"}"})]}),a.open&&i("div",{ref:p,class:"json-context-menu",style:{top:a.y+"px",left:a.x+"px"},children:[i("button",{class:"menu-item",onClick:()=>{xe(a.jsonText),c(f=>({...f,open:!1}))},children:"Copy JSON"}),i("button",{class:"menu-item",onClick:()=>{const f=new Blob([a.jsonText],{type:"application/json"}),u=document.createElement("a");u.href=URL.createObjectURL(f),u.download="data.json",u.click(),c(g=>({...g,open:!1}))},children:"Download JSON"})]})]})}return i("span",{class:"json-unknown",children:String(d)})}function nt({data:e,name:t,depth:n=0,maxInitialDepth:s=2}){return i("div",{class:"json-tree",children:i(te,{value:e,name:t,depth:n,maxInitialDepth:s})})}const Oe={eventPattern:/.*/,fields:[{key:"*",type:"json-tree",maxInitialDepth:1}],priority:0},rt={eventPattern:/llm_start/i,fields:[{key:"prompts",display:"Prompts",type:"json-tree",maxInitialDepth:2},{key:"model",display:"Model",type:"text"},{key:"run_id",display:"Run ID",type:"text"}],priority:10},st={eventPattern:/llm_end/i,fields:[{key:"response",display:"Response",type:"json-tree",maxInitialDepth:2},{key:"run_id",display:"Run ID",type:"text"}],priority:10},ot={eventPattern:/chatbot_(invoked|response_generated|error)/i,fields:[{key:"message_count",display:"Message Count",type:"text"},{key:"response_length",display:"Response Length",type:"text"},{key:"error",display:"Error",type:"json-tree",maxInitialDepth:2}],priority:10},it=[rt,st,ot,Oe];function lt(e){const t=[...it].sort((n,s)=>(s.priority||0)-(n.priority||0));for(const n of t)if(typeof n.eventPattern=="string"){if(n.eventPattern===e)return n}else if(n.eventPattern instanceof RegExp&&n.eventPattern.test(e))return n;return Oe}function ke(e){if(e==null)return!0;const t=typeof e;return t==="string"||t==="number"||t==="boolean"?!(t==="string"&&e.length>80):!(Array.isArray(e)||t==="object")}function Y(e){const t=lt(e.event||""),n=[],s=new Set(["timestamp","event","trace_id","span_id","parent_span_id","level"]);if(t.fields.some(o=>o.key==="*")){const o=t.fields.find(a=>a.key==="*");Object.entries(e).forEach(([a,c])=>{if(!s.has(a)){const p=ke(c)?"text":o.type||"json-tree";n.push({key:a,display:a.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase()),value:c,type:p,maxInitialDepth:o.maxInitialDepth})}})}else t.fields.forEach(o=>{if(e[o.key]!==void 0){const a=o.type||(ke(e[o.key])?"text":"json-tree");n.push({key:o.key,display:o.display||o.key.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),value:e[o.key],type:a,maxInitialDepth:o.maxInitialDepth})}});return n}function He({node:e,trace:t,timestampSettings:n,traceStartTime:s}){const[r,o]=j(!1),a={info:"badge-info",debug:"badge-debug",warn:"badge-warn",error:"badge-error"}[e.level]||"badge-info",c=e.children.length>0,p=e.raw&&e.raw.length>0,_=e.raw&&e.raw.length>1,d=p&&e.raw.some(u=>Y(u).length>0),l=c||_||d,f=l?r?"bi-chevron-down":"bi-chevron-right":"bi-dot";return i("div",{style:{marginLeft:e.depth*16+"px"},children:[i("div",{class:"node-row",children:i("div",{class:"node-content",onClick:()=>l&&o(!r),style:{cursor:l?"pointer":"default"},children:[i("i",{class:`bi ${f} node-icon`}),i("span",{class:"node-message",children:e.msg||"(no event)"}),i("span",{class:`badge ${a} node-badge`,children:e.level}),_&&i("span",{class:"badge badge-secondary ms-1",children:[e.raw.length," logs"]}),d&&!_&&i("i",{class:"bi bi-info-circle text-muted ms-2",title:"Has additional fields"})]})}),!r&&!c&&!_&&d&&e.raw&&e.raw.length===1&&i("div",{style:{marginLeft:"24px",marginTop:"4px"},children:(()=>{const g=Y(e.raw[0]).filter(b=>b.type==="text");return g.length>0&&i("div",{class:"field-chips d-flex flex-wrap gap-1",children:g.map(b=>i("span",{class:"field-chip badge bg-light text-dark border",children:[i("span",{class:"field-chip-label",children:[b.display,":"]}),i("span",{class:"field-chip-value",children:String(b.value)})]},b.key))})})()}),r&&p&&i("div",{class:"node-details",style:{marginLeft:"24px",marginTop:"4px",marginBottom:"8px"},children:e.raw.map((u,g)=>{const[b,w]=j(!1),v=Y(u);return i("div",{class:"log-entry",children:[i("div",{class:"log-entry-header",children:[n.showInNodes&&i("span",{class:"log-timestamp text-muted",children:ee(u.timestamp,n,s)}),i("span",{class:"log-event fw-bold ms-2",children:u.event}),i("button",{class:"btn btn-xxs btn-light text-muted border-0 ms-2 raw-toggle",onClick:()=>w(!b),type:"button",children:b?"hide raw":"raw"})]}),b&&i("pre",{class:"raw-json border rounded p-2 bg-light",children:JSON.stringify(u,null,2)}),v.length>0&&i("div",{class:"log-extra-fields mt-2",children:[i("div",{class:"field-chips d-flex flex-wrap gap-1 mb-2",children:v.filter(h=>h.type==="text").map(h=>i("span",{class:"field-chip badge bg-light text-dark border",children:[i("span",{class:"field-chip-label",children:[h.display,":"]}),i("span",{class:"field-chip-value",children:String(h.value)})]},h.key))}),v.filter(h=>h.type==="json-tree").map(h=>i("div",{class:"field-container mb-2",children:i(nt,{data:h.value,name:h.display,maxInitialDepth:h.maxInitialDepth||1})},h.key))]})]},g)})}),r&&c&&e.children.map(u=>i(He,{node:t.nodes.get(u),trace:t,timestampSettings:n,traceStartTime:s},u))]})}function at(e){if(e<1e3)return`${e}ms`;if(e<6e4)return`${(e/1e3).toFixed(2)}s`;const t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return`${t}m ${n}s`}function ct({forest:e,timestampSettings:t}){const n=Array.from(e.values());return i("div",{class:"traces-container",children:n.map((s,r)=>i("div",{class:"trace-section",children:[i("div",{class:"trace-header-card compact",children:[i("div",{class:"trace-header-line",children:[i("i",{class:"bi bi-diagram-3 me-2"}),i("span",{class:"trace-name small",children:s.name||"Unknown Trace"})]}),i("div",{class:"trace-metadata",children:[i("div",{class:"trace-meta-item",children:[i("i",{class:"bi bi-fingerprint me-1"}),i("span",{class:"text-muted small",children:"ID:"}),i("code",{class:"trace-id-code",children:s.roots.join(", ")||"unknown"})]}),s.startTime&&t.mode!=="hidden"&&t.mode!=="relative"&&i("div",{class:"trace-meta-item",children:[i("i",{class:"bi bi-clock me-1"}),i("span",{class:"text-muted small",children:"Start:"}),i("span",{class:"trace-time",children:ee(s.startTime,t)})]}),s.endTime&&s.startTime!==s.endTime&&t.mode!=="hidden"&&t.mode!=="relative"&&i("div",{class:"trace-meta-item",children:[i("i",{class:"bi bi-clock-history me-1"}),i("span",{class:"text-muted small",children:"End:"}),i("span",{class:"trace-time",children:ee(s.endTime,t)})]}),s.durationMs!==void 0&&s.durationMs>0&&i("div",{class:"trace-meta-item",children:[i("i",{class:"bi bi-hourglass-split me-1"}),i("span",{class:"text-muted small",children:"Duration:"}),i("span",{class:"trace-duration badge bg-secondary",children:at(s.durationMs)})]})]})]}),i("div",{class:"trace-tree",children:s.roots.map(o=>{const a=s.nodes.get(o);return i(He,{node:a,trace:s,timestampSettings:t,traceStartTime:s.startTime},o)})})]},r))})}function _t({settings:e,onSettingsChange:t}){const[n,s]=j(!1);function r(p){const _=p.target;t({...e,mode:_.value})}function o(p){const _=p.target;t({...e,decimalPlaces:parseInt(_.value,10)})}function a(){t({...e,forceEnUS:!e.forceEnUS})}function c(){t({...e,showInNodes:!e.showInNodes})}return i("div",{class:"timestamp-settings-container",children:[i("button",{class:"btn btn-outline-secondary btn-sm",onClick:()=>s(!n),type:"button",children:[i("i",{class:"bi bi-clock-history me-1"}),"Timestamp Format",i("i",{class:`bi bi-chevron-${n?"up":"down"} ms-1`})]}),n&&i("div",{class:"timestamp-settings-panel",children:[i("div",{class:"setting-group",children:[i("label",{class:"setting-label",children:[i("i",{class:"bi bi-layout-text-window me-1"}),"Display Mode:"]}),i("select",{class:"form-select form-select-sm",value:e.mode,onChange:r,children:[i("option",{value:"full",children:"Full Date & Time"}),i("option",{value:"time",children:"Time Only"}),i("option",{value:"relative",children:"Relative to Start"}),i("option",{value:"hidden",children:"Hidden"})]}),i("small",{class:"text-muted setting-hint",children:[e.mode==="full"&&"Oct 24, 10:31:44.917 AM",e.mode==="time"&&"10:31:44.917 AM",e.mode==="relative"&&"+1.857s",e.mode==="hidden"&&"Timestamps hidden"]})]}),e.mode==="relative"&&i("div",{class:"setting-group",children:[i("label",{class:"setting-label",children:[i("i",{class:"bi bi-dash-circle me-1"}),"Decimal Places:"]}),i("input",{type:"number",class:"form-control form-control-sm",value:e.decimalPlaces,min:"0",max:"6",onChange:o}),i("small",{class:"text-muted setting-hint",children:["Example: +",1.857123.toFixed(e.decimalPlaces),"s"]})]}),(e.mode==="time"||e.mode==="full")&&i("div",{class:"setting-group",children:[i("label",{class:"setting-checkbox",children:[i("input",{type:"checkbox",class:"form-check-input me-2",checked:e.forceEnUS,onChange:a}),i("span",{children:"Force en-US locale"})]}),i("small",{class:"text-muted setting-hint",children:e.forceEnUS?"Using US format (AM/PM, MM/DD)":"Using browser locale"})]}),i("div",{class:"setting-group",children:i("label",{class:"setting-checkbox",children:[i("input",{type:"checkbox",class:"form-check-input me-2",checked:e.showInNodes,onChange:c}),i("span",{children:"Show timestamps in log entries"})]})})]})]})}function dt(){var h,E;const[e,t]=j(null),[n,s]=j(!1),[r,o]=j([]),[a,c]=j(""),[p,_]=j(!1),[d,l]=j(et());Ue(()=>{fetch("/samples/config.json").then(m=>m.json()).then(m=>{o(m.samples),m.samples.length>0&&c(m.samples[0].id)}).catch(m=>console.error("Failed to load samples config:",m))},[]);async function f(m){const T=r.find(x=>x.id===m);if(T){_(!0);try{const L=(await(await fetch(`/samples/${T.filename}`)).text()).trim().split(`
`).map(D=>JSON.parse(D));t(ye(L))}catch(x){console.error("Failed to load sample:",x),alert("Failed to load sample file")}finally{_(!1)}}}function u(m){const x=m.target.value;c(x),f(x)}function g(m){const T=new FileReader;T.onload=x=>{var D;const L=((D=x.target)==null?void 0:D.result).trim().split(`
`).map(U=>JSON.parse(U));t(ye(L))},T.readAsText(m)}function b(m){var x;m.preventDefault(),s(!1);const T=(x=m.dataTransfer)==null?void 0:x.files[0];T&&g(T)}function w(m){var N;const x=(N=m.target.files)==null?void 0:N[0];x&&g(x)}function v(m){l(m),tt(m)}return i("div",{class:"container-fluid py-3",children:[i("div",{class:"trace-header d-flex align-items-center",children:[i("i",{class:"bi bi-diagram-3 me-2"}),i("span",{children:"AI Trace Viewer"})]}),i("div",{class:"controls-section",children:[i("div",{class:"row g-2 mb-2",children:[i("div",{class:"col-auto",children:i("select",{class:"form-select form-select-sm",value:a,onChange:u,disabled:p||r.length===0,children:[r.length===0&&i("option",{children:"Loading samples..."}),r.map(m=>i("option",{value:m.id,children:m.name},m.id))]})}),i("div",{class:"col-auto",children:i("button",{onClick:()=>f(a),class:"btn btn-primary btn-sm",disabled:p||!a,children:[i("i",{class:"bi bi-play-fill me-1"}),p?"Loading...":"Load"]})}),i("div",{class:"col-auto",children:i("input",{type:"file",accept:".jsonl,.ndjson",onChange:w,class:"form-control form-control-sm",style:{width:"200px"}})}),i("div",{class:"col-auto ms-auto",children:i(_t,{settings:d,onSettingsChange:v})})]}),a&&r.find(m=>m.id===a)&&i("div",{class:"sample-info mb-2",children:[i("i",{class:`bi ${(h=r.find(m=>m.id===a))==null?void 0:h.icon} me-2 text-primary`}),i("small",{class:"text-muted",children:(E=r.find(m=>m.id===a))==null?void 0:E.description})]}),i("div",{class:`upload-area ${n?"drag-active":""}`,onDrop:b,onDragOver:m=>{m.preventDefault(),s(!0)},onDragLeave:()=>s(!1),children:[i("i",{class:"bi bi-cloud-upload me-2"}),"Drop NDJSON/JSONL file here"]})]}),e&&i(ct,{forest:e,timestampSettings:d})]})}ze(i(dt,{}),document.getElementById("app"));
